<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Search</title>
    <link rel="stylesheet" href="homepage.css">
</head>

<body>
<div class="form-container">
    <div class="form-box">
        <div class="form-title-box">
            <h2 class="form-title-box-l1">Weather Search</h2>
            <h3 class="form-title-box-l2">Fill out the form to get weather info!</h3>
        </div>
        <form class="form-body-box" id="weatherForm">
            <div class="input-group">
                <label for="street">
                    <div class="item-name better-blue">Street</div>
                    <div class="star">*</div>
                </label>
                <input type="text" id="street" placeholder="" class="input-l1" required>
            </div>
            <div class="flex-space-between">
                <div class="input-group">
                    <label for="city">
                        <div class="item-name better-blue" style="margin-right: 2px">City</div>
                        <div class="star">*</div>
                    </label>
                    <input type="text" id="city" placeholder="" style="width: 245px; margin-top: 10px" required>
                </div>
                <div class="input-group">
                    <label for="state">
                        <div class="item-name better-blue" style="margin-right: 2px">State</div>
                        <div class="star">*</div>
                    </label>
                    <select id="state" style="width: 245px; margin-top: 10px" required>
                        <option value="">Select your state</option>
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="DC">District Of Columbia</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>
            </div>
            <hr class="hr-set better-blue">
            <div class="input-group">
                <label for="auto-detect" class="auto-loc better-blue">
                    Want us to auto-detect your location? Check here<input type="checkbox" id="auto-detect">
                </label>
            </div>
            <div class="button-group">
                <button type="submit" class="submit-btn better-bg-blue">SUBMIT</button>
                <button type="reset" class="clear-btn better-bg-orange">CLEAR</button>
            </div>
        </form>
    </div>
</div>

<!--<figure class="highcharts2-figure colored-border">-->
<!--    <div id="highcharts2-container"></div>-->
<!--</figure>-->


<div id="error-box" class="better-blue">No records have been found</div>


<div id="weatherAndTableHidden" class="results-container">
    <div id="results-today-box" class="results-today-box">
        <div id="location" class="location">
            Loading location...
        </div>
        <div class="today-weather-info">
            <div class="main-info">
                <div class="weather-status-main">
                    <img id="weather-img" class="weather-img-main"
                         src="resources/Images/Weather%20Symbols%20for%20Weather%20Codes/clear_day.svg">
                    <p id="weather-description">Loading...</p>
                </div>
                <div id="temperature" class="temperature-font">
                    --°
                </div>
            </div>
            <div class="details-main">
                <div class="detail-item-main">
                    <p>Humidity</p>
                    <img src="resources/Images/humidity.png" alt="humidity">
                    <p id="humidity">--%</p>
                </div>
                <div class="detail-item-main">
                    <p>Pressure</p>
                    <img src="resources/Images/Pressure.png" alt="pressure">
                    <p id="pressure">--inHg</p>
                </div>
                <div class="detail-item-main">
                    <p>Wind Speed</p>
                    <img src="resources/Images/Wind_Speed.png" alt="wind speed">
                    <p id="wind-speed">--mph</p>
                </div>
                <div class="detail-item-main">
                    <p>Visibility</p>
                    <img src="resources/Images/Visibility.png" alt="visibility">
                    <p id="visibility">--mi</p>
                </div>
                <div class="detail-item-main">
                    <p>Cloud Cover</p>
                    <img src="resources/Images/Cloud_Cover.png" alt="cloud cover">
                    <p id="cloud-cover">--%</p>
                </div>
                <div class="detail-item-main">
                    <p>UV Level</p>
                    <img src="resources/Images/UV_Level.png" alt="UV Level">
                    <p id="uv-level">--</p>
                </div>
            </div>
        </div>
    </div>

    <div id="tableHidden" class="tableContainer">
        <table>
            <thead class="table-head better-bg-blue">
            <tr>
                <th>Date</th>
                <th>Status</th>
                <th>Temp High</th>
                <th>Temp Low</th>
                <th>Wind Speed</th>
            </tr>
            </thead>
            <tbody id="weather-table"></tbody>
        </table>
    </div>

    <div id="weatherDetails" class="weather-details-container">
        <div class="detail-title-box">
            <div class="weather-detail-font">Daily Weather Details</div>
            <hr class="detail-hr">
        </div>
        <div class="weather-card">
            <div class="card-head flex-space-between">
                <div class="card-head-data flex-column">
                    <p id="weatherDate" class="card-head-font1 better-blue"></p>
                    <p id="weatherStatus" class="card-head-font1 better-blue"></p>
                    <p id="weatherTemp" class="card-head-font2 better-blue"></p>
                </div>
                <img src="resources/Images/Weather%20Symbols%20for%20Weather%20Codes/clear_day.svg" id="card-head-img">
            </div>
            <div class="card-body">
                <div class="data-label">Precipitation:</div>
                <div id="weatherPrecipitation" class="data-value"></div>
                <div class="data-label">Chance of Rain:</div>
                <div id="weatherRain" class="data-value"></div>
                <div class="data-label">Wind Speed:</div>
                <div id="weatherWind" class="data-value"></div>
                <div class="data-label">Humidity:</div>
                <div id="weatherHumidity" class="data-value"></div>
                <div class="data-label">Visibility:</div>
                <div id="weatherVisibility" class="data-value"></div>
                <div class="data-label">Sunrise/Sunset:</div>
                <div id="weatherSunriseSunset" class="data-value"></div>
            </div>
        </div>
        <div class="charts-title-box detail-title-box">
            <div class="charts-title-font weather-detail-font">Weather Charts</div>
            <hr class="charts-hr detail-hr">
            <img id="pointDown" src="resources/Images/point-down-512.png" onclick="chart_display_status_change()"/>
        </div>

        <div id="charts-display">
            <figure class="highcharts1-figure">
                <div id="highcharts1-container"></div>
            </figure>
            <figure class="highcharts2-figure">
                <div id="highcharts2-container"></div>
            </figure>
        </div>
    </div>
</div>

<script src="https://code.highcharts.com/highcharts.js"></script>

<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>

<script src="https://code.highcharts.com/modules/datagrouping.js"></script>
<script src="https://code.highcharts.com/modules/windbarb.js"></script>
<script src="https://code.highcharts.com/modules/pattern-fill.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>

<script src="https://code.highcharts.com/modules/accessibility.js"></script>

<script src="homepage.js"></script>

<script>
    function Meteogram(json, container) {
        // Parallel arrays for the chart data, these are populated as the JSON file
        // is loaded
        this.symbols = []
        this.precipitations = []
        this.precipitationsError = [] // Only for some data sets
        this.winds = []
        this.temperatures = []
        this.pressures = []

        // Initialize
        this.json = json
        this.container = container

        // Run
        this.parseYrData()
    }

    /**
     * Mapping of the symbol code in yr.no's API to the icons in their public
     * GitHub repo, as well as the text used in the tooltip.
     *
     * https://api.met.no/weatherapi/weathericon/2.0/documentation
     */
    Meteogram.dictionary = {
        clearsky: {
            symbol: "01",
            text: "Clear sky",
        },
        fair: {
            symbol: "02",
            text: "Fair",
        },
        partlycloudy: {
            symbol: "03",
            text: "Partly cloudy",
        },
        cloudy: {
            symbol: "04",
            text: "Cloudy",
        },
        lightrainshowers: {
            symbol: "40",
            text: "Light rain showers",
        },
        rainshowers: {
            symbol: "05",
            text: "Rain showers",
        },
        heavyrainshowers: {
            symbol: "41",
            text: "Heavy rain showers",
        },
        lightrainshowersandthunder: {
            symbol: "24",
            text: "Light rain showers and thunder",
        },
        rainshowersandthunder: {
            symbol: "06",
            text: "Rain showers and thunder",
        },
        heavyrainshowersandthunder: {
            symbol: "25",
            text: "Heavy rain showers and thunder",
        },
        lightsleetshowers: {
            symbol: "42",
            text: "Light sleet showers",
        },
        sleetshowers: {
            symbol: "07",
            text: "Sleet showers",
        },
        heavysleetshowers: {
            symbol: "43",
            text: "Heavy sleet showers",
        },
        lightsleetshowersandthunder: {
            symbol: "26",
            text: "Light sleet showers and thunder",
        },
        sleetshowersandthunder: {
            symbol: "20",
            text: "Sleet showers and thunder",
        },
        heavysleetshowersandthunder: {
            symbol: "27",
            text: "Heavy sleet showers and thunder",
        },
        lightsnowshowers: {
            symbol: "44",
            text: "Light snow showers",
        },
        snowshowers: {
            symbol: "08",
            text: "Snow showers",
        },
        heavysnowshowers: {
            symbol: "45",
            text: "Heavy show showers",
        },
        lightsnowshowersandthunder: {
            symbol: "28",
            text: "Light snow showers and thunder",
        },
        snowshowersandthunder: {
            symbol: "21",
            text: "Snow showers and thunder",
        },
        heavysnowshowersandthunder: {
            symbol: "29",
            text: "Heavy snow showers and thunder",
        },
        lightrain: {
            symbol: "46",
            text: "Light rain",
        },
        rain: {
            symbol: "09",
            text: "Rain",
        },
        heavyrain: {
            symbol: "10",
            text: "Heavy rain",
        },
        lightrainandthunder: {
            symbol: "30",
            text: "Light rain and thunder",
        },
        rainandthunder: {
            symbol: "22",
            text: "Rain and thunder",
        },
        heavyrainandthunder: {
            symbol: "11",
            text: "Heavy rain and thunder",
        },
        lightsleet: {
            symbol: "47",
            text: "Light sleet",
        },
        sleet: {
            symbol: "12",
            text: "Sleet",
        },
        heavysleet: {
            symbol: "48",
            text: "Heavy sleet",
        },
        lightsleetandthunder: {
            symbol: "31",
            text: "Light sleet and thunder",
        },
        sleetandthunder: {
            symbol: "23",
            text: "Sleet and thunder",
        },
        heavysleetandthunder: {
            symbol: "32",
            text: "Heavy sleet and thunder",
        },
        lightsnow: {
            symbol: "49",
            text: "Light snow",
        },
        snow: {
            symbol: "13",
            text: "Snow",
        },
        heavysnow: {
            symbol: "50",
            text: "Heavy snow",
        },
        lightsnowandthunder: {
            symbol: "33",
            text: "Light snow and thunder",
        },
        snowandthunder: {
            symbol: "14",
            text: "Snow and thunder",
        },
        heavysnowandthunder: {
            symbol: "34",
            text: "Heavy snow and thunder",
        },
        fog: {
            symbol: "15",
            text: "Fog",
        },
    }

    /**
     * Draw the weather symbols on top of the temperature series. The symbols are
     * fetched from yr.no's MIT licensed weather symbol collection.
     * https://github.com/YR/weather-symbols
     */
    Meteogram.prototype.drawWeatherSymbols = function (chart) {
        chart.series[0].data.forEach((point, i) => {
            if (this.resolution > 36e5 || i % 2 === 0) {
                const [symbol, specifier] = this.symbols[i].split("_"),
                    icon =
                        Meteogram.dictionary[symbol].symbol +
                        ({day: "d", night: "n"}[specifier] || "")

                if (Meteogram.dictionary[symbol]) {
                    chart.renderer
                        .image(
                            "https://cdn.jsdelivr.net/gh/nrkno/yr-weather-symbols" +
                            `@8.0.1/dist/svg/${icon}.svg`,
                            point.plotX + chart.plotLeft - 8,
                            point.plotY + chart.plotTop - 30,
                            30,
                            30,
                        )
                        .attr({
                            zIndex: 5,
                        })
                        .add()
                } else {
                    console.log(symbol)
                }
            }
        })
    }

    /**
     * Draw blocks around wind arrows, below the plot area
     */
    Meteogram.prototype.drawBlocksForWindArrows = function (chart) {
        const xAxis = chart.xAxis[0]

        for (
            let pos = xAxis.min, max = xAxis.max, i = 0;
            pos <= max + 36e5;
            pos += 36e5, i += 1
        ) {
            // Get the X position
            const isLast = pos === max + 36e5,
                x = Math.round(xAxis.toPixels(pos)) + (isLast ? 0.5 : -0.5)

            // Draw the vertical dividers and ticks
            const isLong =
                this.resolution > 36e5 ? pos % this.resolution === 0 : i % 2 === 0

            chart.renderer
                .path([
                    "M",
                    x,
                    chart.plotTop + chart.plotHeight + (isLong ? 0 : 28),
                    "L",
                    x,
                    chart.plotTop + chart.plotHeight + 32,
                    "Z",
                ])
                .attr({
                    stroke: chart.options.chart.plotBorderColor,
                    "stroke-width": 1,
                })
                .add()
        }

        // Center items in block
        chart.get("windbarbs").markerGroup.attr({
            translateX: chart.get("windbarbs").markerGroup.translateX + 8,
        })
    }

    /**
     * Build and return the Highcharts options structure
     */
    Meteogram.prototype.getChartOptions = function () {
        return {
            chart: {
                renderTo: document.getElementById("highcharts2-container"),
                marginBottom: 70,
                marginRight: 40,
                marginTop: 50,
                plotBorderWidth: 1,
                height: 400,
                alignTicks: false,
                scrollablePlotArea: {
                    minWidth: 720,
                },
            },

            defs: {
                patterns: [
                    {
                        id: "precipitation-error",
                        path: {
                            d: [
                                "M",
                                3.3,
                                0,
                                "L",
                                -6.7,
                                10,
                                "M",
                                6.7,
                                0,
                                "L",
                                -3.3,
                                10,
                                "M",
                                10,
                                0,
                                "L",
                                0,
                                10,
                                "M",
                                13.3,
                                0,
                                "L",
                                3.3,
                                10,
                                "M",
                                16.7,
                                0,
                                "L",
                                6.7,
                                10,
                            ].join(" "),
                            stroke: "#68CFE8",
                            strokeWidth: 1,
                        },
                    },
                ],
            },

            title: {
                text: "Hourly Weather (For Next 5 days)",
                align: "center",
                style: {
                    whiteSpace: "nowrap",
                    textOverflow: "ellipsis",
                },
            },

            credits: {
                text: 'Forecast',
                href: "https://yr.no",
                position: {
                    x: -40,
                },
            },

            tooltip: {
                shared: true,
                useHTML: true,
                headerFormat:
                    "<small>{point.x:%A, %b %e, %H:%M} - " +
                    "{point.point.to:%H:%M}</small><br>" +
                    "<b>{point.point.symbolName}</b><br>",
            },

            xAxis: [
                {
                    // Bottom X axis
                    type: "datetime",
                    tickInterval: 2 * 36e5, // two hours
                    minorTickInterval: 36e5, // one hour
                    tickLength: 0,
                    gridLineWidth: 1,
                    gridLineColor: "rgba(128, 128, 128, 0.1)",
                    startOnTick: false,
                    endOnTick: false,
                    minPadding: 0,
                    maxPadding: 0,
                    offset: 30,
                    showLastLabel: true,
                    labels: {
                        format: "{value:%H}",
                    },
                    crosshair: true,
                },
                {
                    // Top X axis
                    linkedTo: 0,
                    type: "datetime",
                    tickInterval: 24 * 3600 * 1000,
                    labels: {
                        format:
                            '{value:<span style="font-size: 12px; font-weight: ' +
                            'bold">%a</span> %b %e}',
                        align: "left",
                        x: 3,
                        y: 8,
                    },
                    opposite: true,
                    tickLength: 20,
                    gridLineWidth: 1,
                },
            ],

            yAxis: [
                {
                    // temperature axis
                    title: {
                        text: null,
                    },
                    labels: {
                        format: "{value}°",
                        style: {
                            fontSize: "10px",
                        },
                        x: -3,
                    },
                    plotLines: [
                        {
                            // zero plane
                            value: 0,
                            color: "#BBBBBB",
                            width: 1,
                            zIndex: 2,
                        },
                    ],
                    maxPadding: 0.3,
                    minRange: 8,
                    tickInterval: 1,
                    gridLineColor: "rgba(128, 128, 128, 0.1)",
                },
                {
                    // precipitation axis
                    title: {
                        text: null,
                    },
                    labels: {
                        enabled: false,
                    },
                    gridLineWidth: 0,
                    tickLength: 0,
                    minRange: 10,
                    min: 0,
                },
                {
                    // Air pressure
                    allowDecimals: false,
                    title: {
                        // Title on top of axis
                        text: "inHg",
                        offset: 0,
                        align: "high",
                        rotation: 0,
                        style: {
                            fontSize: "10px",
                            // color: Highcharts.getOptions().colors[2],
                            color: "orange",
                        },
                        textAlign: "left",
                        x: 3,
                    },
                    labels: {
                        style: {
                            fontSize: "8px",
                            // color: Highcharts.getOptions().colors[2],
                            color: "orange",
                        },
                        y: 2,
                        x: 3,
                    },
                    plotLines: [{
                        value: 30, // 横线的位置，数值为 29
                        color: 'orange', // 线条颜色为黄色
                        dashStyle: 'ShortDot', // 使用点状线条
                        width: 2, // 线条宽度
                        label: {
                            text: '', // 显示的标签
                            align: 'right',
                            style: {
                                color: 'yellow'
                            }
                        },
                        zIndex: 5 // 保证线在最上层
                    }],
                    gridLineWidth: 0,
                    opposite: true,
                    showLastLabel: false,
                },
            ],

            legend: {
                enabled: false,
            },

            plotOptions: {
                series: {
                    pointPlacement: "between",
                },
            },

            series: [
                // {
                //     name: "Temperature",
                //     data: this.temperatures,
                //     type: "spline",
                //     marker: {
                //         enabled: false,
                //         states: {
                //             hover: {
                //                 enabled: true,
                //             },
                //         },
                //     },
                //     tooltip: {
                //         pointFormat:
                //             '<span style="color:{point.color}">\u25CF</span>' +
                //             " " +
                //             "{series.name}: <b>{point.y}°C</b><br/>",
                //     },
                //     zIndex: 1,
                //     color: "#FF3333",
                //     negativeColor: "#48AFE8",
                // },
                {
                    name: "Temperature",
                    data: this.temperatures,
                    type: "column",
                    color: "#68CFE8",
                    yAxis: 0,
                    groupPadding: 0,
                    pointPadding: 0,
                    grouping: false,
                    dataLabels: {
                        enabled: !this.hasPrecipitationError,
                        filter: {
                            operator: ">",
                            property: "y",
                            value: 0,
                        },
                        style: {
                            fontSize: "10px",
                            color: "#666",
                        },
                    },
                    tooltip: {
                        valueSuffix: " °F",
                    },
                },
                // {
                //     name: "Precipitation",
                //     data: this.precipitationsError,
                //     type: "column",
                //     color: "url(#precipitation-error)",
                //     yAxis: 1,
                //     groupPadding: 0,
                //     pointPadding: 0,
                //     tooltip: {
                //         valueSuffix: " mm",
                //         pointFormat:
                //             '<span style="color:{point.color}">\u25CF</span>' +
                //             " " +
                //             "{series.name}: <b>{point.minvalue} mm - " +
                //             "{point.maxvalue} mm</b><br/>",
                //     },
                //     grouping: false,
                //     dataLabels: {
                //         enabled: this.hasPrecipitationError,
                //         filter: {
                //             operator: ">",
                //             property: "maxValue",
                //             value: 0,
                //         },
                //         style: {
                //             fontSize: "8px",
                //             color: "gray",
                //         },
                //     },
                // },
                // {
                //     name: "Precipitation",
                //     data: this.precipitations,
                //     type: "column",
                //     color: "#68CFE8",
                //     yAxis: 1,
                //     groupPadding: 0,
                //     pointPadding: 0,
                //     grouping: false,
                //     dataLabels: {
                //         enabled: !this.hasPrecipitationError,
                //         filter: {
                //             operator: ">",
                //             property: "y",
                //             value: 0,
                //         },
                //         style: {
                //             fontSize: "8px",
                //             color: "#666",
                //         },
                //     },
                //     tooltip: {
                //         valueSuffix: " mm",
                //     },
                // },
                {
                    name: "Air pressure",
                    // color: Highcharts.getOptions().colors[2],
                    color: "red",
                    data: this.pressures,
                    marker: {
                        enabled: false,
                    },
                    shadow: false,
                    tooltip: {
                        valueSuffix: " inHg",
                    },
                    // dashStyle: "shortdot",
                    yAxis: 2,
                },
                {
                    name: "Wind",
                    type: "windbarb",
                    id: "windbarbs",
                    color: Highcharts.getOptions().colors[1],
                    lineWidth: 1.5,
                    data: this.winds,
                    vectorLength: 18,
                    yOffset: -15,
                    tooltip: {
                        valueSuffix: " m/s",
                    }
                },
            ],
        }
    }

    /**
     * Post-process the chart from the callback function, the second argument
     * Highcharts.Chart.
     */
    Meteogram.prototype.onChartLoad = function (chart) {
        // this.drawWeatherSymbols(chart)
        this.drawBlocksForWindArrows(chart)
    }

    /**
     * Create the chart. This function is called async when the data file is loaded
     * and parsed.
     */
    Meteogram.prototype.createChart = function () {
        this.chart = new Highcharts.Chart(this.getChartOptions(), (chart) => {
            this.onChartLoad(chart)
        })
    }

    Meteogram.prototype.error = function () {
        console.log("error")
        document.getElementById("loading").innerHTML =
            '<i class="fa fa-frown-o"></i> Failed loading data, please try again ' +
            "later"
    }

    /**
     * Handle the data. This part of the code is not Highcharts specific, but deals
     * with yr.no's specific data format
     */
    Meteogram.prototype.parseYrData = function () {
        console.log(this.json)
        let pointStart

        if (!this.json) {
            return this.error()
        }

        // Loop over hourly (or 6-hourly) forecasts
        this.json.data.timelines[0].intervals.forEach((node, i) => {
            const x = Date.parse(node.startTime.slice(0, 19))
            // nextHours = node.data.next_1_hours || node.data.next_6_hours,
            // symbolCode = nextHours && nextHours.summary.symbol_code,
            // to = node.data.next_1_hours ? x + 36e5 : x + 6 * 36e5

            // if (to > pointStart + 48 * 36e5) {
            //     return
            // }

            // Populate the parallel arrays
            // this.symbols.push(nextHours.summary.symbol_code)

            this.temperatures.push({
                x,
                y: node.values.temperature,
                // custom options used in the tooltip formatter
                // to,
                // symbolName:
                // Meteogram.dictionary[symbolCode.replace(/_(day|night)$/, "")].text,
            })

            // this.precipitations.push({
            //     x,
            //     y: nextHours.details.precipitation_amount,
            // })


            this.winds.push({
                x,
                value: node.values.windSpeed,
                direction: node.values.windDirection,
            })

            // if (i % 2 === 0) {
            //     this.winds.push({
            //         x,
            //         value: node.values.windSpeed,
            //         direction: node.values.windDirection,
            //     })
            // }

            this.pressures.push({
                x,
                y: node.values.pressureSeaLevel,
            })

            if (i === 0) {
                pointStart = (x + x + 36e5) / 2
                // pointStart = (x + to) / 2
            }
        })

        // Create the chart when the data is loaded
        this.createChart()
    }
    // }Meteogram.prototype.parseYrData = function () {
    //     let pointStart
    //
    //     if (!this.json) {
    //         return this.error()
    //     }
    //
    //     // Loop over hourly (or 6-hourly) forecasts
    //     this.json.properties.timeseries.forEach((node, i) => {
    //         const x = Date.parse(node.time),
    //             nextHours = node.data.next_1_hours || node.data.next_6_hours,
    //             symbolCode = nextHours && nextHours.summary.symbol_code,
    //             to = node.data.next_1_hours ? x + 36e5 : x + 6 * 36e5
    //
    //         if (to > pointStart + 48 * 36e5) {
    //             return
    //         }
    //
    //         // Populate the parallel arrays
    //         this.symbols.push(nextHours.summary.symbol_code)
    //
    //         this.temperatures.push({
    //             x,
    //             y: node.data.instant.details.air_temperature,
    //             // custom options used in the tooltip formatter
    //             to,
    //             symbolName:
    //             Meteogram.dictionary[symbolCode.replace(/_(day|night)$/, "")].text,
    //         })
    //
    //         this.precipitations.push({
    //             x,
    //             y: nextHours.details.precipitation_amount,
    //         })
    //
    //         if (i % 2 === 0) {
    //             this.winds.push({
    //                 x,
    //                 value: node.data.instant.details.wind_speed,
    //                 direction: node.data.instant.details.wind_from_direction,
    //             })
    //         }
    //
    //         this.pressures.push({
    //             x,
    //             y: node.data.instant.details.air_pressure_at_sea_level,
    //         })
    //
    //         if (i === 0) {
    //             pointStart = (x + to) / 2
    //         }
    //     })
    //
    //     // Create the chart when the data is loaded
    //     this.createChart()
    // }
    // End of the Meteogram protype

    // On DOM ready...

    // Set the hash to the yr.no URL we want to parse
    function chart2_generation(lat, lng){
        if (!location.hash) {
        location.hash =
            "http://127.0.0.1:5000/weatherdatachart2?latitude=42.3478&longitude=-71.0466"
    }

    // const url = location.hash.substr(1)
    const url = `http://127.0.0.1:5000/weatherdatachart2?latitude=${lat}&longitude=${lng}`;
    console.log(url)
    Highcharts.ajax({
        url,
        dataType: "json",
        success: (json) => {
            window.meteogram = new Meteogram(json, "highcharts2-container")
        },
        error: Meteogram.prototype.error,
        headers: {
            // Override the Content-Type to avoid preflight problems with CORS
            // in the Highcharts demos
            "Content-Type": "text/plain",
        },
    })
    }
</script>
</body>
</html>
